# Auto Archive Renamer & Analyzer

Автоматизированная система для анализа архивов и документов с последующим предложением корректного имени на основе содержимого. Поддерживает широкий спектр форматов документов, архивов и изображений с возможностью OCR.

---

## Основные возможности

- Распаковка архивов (ZIP, RAR) и анализ содержимого.
- Определение основного документа в архиве.
- Извлечение текста из файлов разных форматов:
  - Документы: DOCX, PDF, EPUB, FB2, DJVU
  - Простые тексты: TXT
  - Изображения с текстом: PNG, JPG, TIFF, GIF
- Поддержка OCR через Tesseract для PDF, DJVU и изображений.
- Получение метаданных из поддерживаемых форматов.
- Взаимодействие с LLM (например, Google Gemini) для анализа текста и генерации предложенного имени архива.
- Возможность автоматического переименования через ключ `--rename`.
- Настраиваемый уровень логирования и веселый режим для развлекательного вывода.

---

## Структура проекта

### Корневые файлы

- **archive_tools.py** – функции для работы с архивами: распаковка, получение структуры и метаданных.
- **config.py** – конфигурационные параметры проекта, пути и опции OCR.
- **file_tools.py** – утилиты для работы с файлами внутри архивов, извлечение текста и поиск файлов.
- **llm_client.py** – интерфейс для работы с LLM: отправка промптов и получение ответов.
- **main.py** – основной исполняемый файл; обработка архива, извлечение текста, взаимодействие с LLM, предложение переименования.
- **prompts.py** – генерация промптов для LLM: анализ архива и извлеченного текста.
- **requirements.txt** – список зависимостей проекта для установки через pip.

### Папка `formats/`

- **`__init__.py`** – регистрация всех обработчиков форматов и возврат подходящего обработчика для файла.
- **base_handler.py** – базовый абстрактный класс для всех обработчиков форматов.
- **djvu_handler.py** – обработка DJVU файлов, поддержка OCR через pytesseract.
- **docx_handler.py** – обработка DOCX/DOC файлов, извлечение текста и метаданных.
- **epub_handler.py** – обработка EPUB файлов, извлечение текста и метаданных, поддержка fallback метода.
- **fb2_handler.py** – обработка FB2 файлов, извлечение заголовка и текста.
- **image_handler.py** – обработка изображений с OCR (PNG, JPG, TIFF, GIF), поддержка русского и английского языков.
- **ocr_utils.py** – вспомогательные функции для OCR: конвертация DJVU/PDF страниц в изображения и вызов pytesseract.
- **pdf_handler.py** – обработка PDF файлов с использованием PyPDF2 и OCR для страниц с изображениями.
- **txt_handler.py** – обработка TXT файлов, извлечение первых символов или всего текста.
- **zip_handler.py** – обработка архивов ZIP и RAR, возвращает список содержимого.

---

## Установка

1. Клонировать репозиторий:

```bash
git clone https://github.com/username/repo.git
cd repo
```
2. Установить зависимости:

```bash
pip install -r requirements.txt
```
Для OCR необходимо установить Tesseract OCR и Pillow.

## Использование

```bash
python main.py --file "archive.rar" [--rename]
```
- --file – путь к архиву для анализа.
  
- --rename – автоматически применять предложенное LLM имя архива. Если ключ не указан, программа спросит пользователя.
